<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:flowable="http://flowable.org/bpmn"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI"
             typeLanguage="http://www.w3.org/2001/XMLSchema"
             expressionLanguage="http://www.w3.org/1999/XPath"
             targetNamespace="http://werkflow.com/bpmn/capex">

  <process id="capex-approval-process-v2" name="CapEx Approval Process V2 (REST)" isExecutable="true">

    <documentation>Capital Expenditure approval workflow with multi-level approvals based on amount thresholds. V2 uses RestServiceDelegate pattern for inter-service communication.</documentation>

    <!-- Start Event -->
    <startEvent id="startEvent" name="CapEx Request Submitted" flowable:formKey="capex-request">
      <documentation>Employee submits a capital expenditure request</documentation>
    </startEvent>

    <!-- Script Task: Create CapEx Request via REST API -->
    <scriptTask id="createCapExRequest" name="Create CapEx Request" scriptFormat="groovy">
      <documentation>Creates CapEx request record in Finance Service via REST API</documentation>
      <script>
        <![CDATA[
          import groovy.json.JsonBuilder
          import groovy.json.JsonSlurper
          import java.net.HttpURLConnection

          def financeServiceUrl = execution.getVariable('financeServiceUrl')
          def url = new URL("${financeServiceUrl}/api/workflow/capex/create-request")
          def connection = url.openConnection() as HttpURLConnection

          connection.setRequestMethod('POST')
          connection.setDoOutput(true)
          connection.setRequestProperty('Content-Type', 'application/json')
          connection.setConnectTimeout(15000)
          connection.setReadTimeout(15000)

          def requestBody = [
            title: execution.getVariable('title'),
            description: execution.getVariable('description'),
            category: execution.getVariable('category'),
            amount: execution.getVariable('requestAmount'),
            priority: execution.getVariable('priority'),
            approvalLevel: execution.getVariable('approvalLevel'),
            businessJustification: execution.getVariable('businessJustification'),
            expectedBenefits: execution.getVariable('expectedBenefits'),
            expectedCompletionDate: execution.getVariable('expectedCompletionDate'),
            budgetYear: execution.getVariable('budgetYear'),
            departmentName: execution.getVariable('departmentName'),
            requestedBy: execution.getVariable('requestedBy')
          ]

          def jsonBody = new JsonBuilder(requestBody).toString()
          connection.outputStream.withWriter { it.write(jsonBody) }

          def responseCode = connection.responseCode
          if (responseCode == 200 || responseCode == 201) {
            def response = new JsonSlurper().parseText(connection.inputStream.text)
            execution.setVariable('capexId', response.capexId)
            execution.setVariable('requestNumber', response.requestNumber)
          } else {
            throw new RuntimeException("Failed to create CapEx request: HTTP ${responseCode}")
          }
        ]]>
      </script>
    </scriptTask>

    <!-- Script Task: Check Budget Availability via REST API -->
    <scriptTask id="checkBudget" name="Check Budget Availability" scriptFormat="groovy">
      <documentation>Verifies if budget is available for the requested amount</documentation>
      <script>
        <![CDATA[
          import groovy.json.JsonBuilder
          import groovy.json.JsonSlurper
          import java.net.HttpURLConnection

          def financeServiceUrl = execution.getVariable('financeServiceUrl')
          def url = new URL("${financeServiceUrl}/api/workflow/capex/check-budget")
          def connection = url.openConnection() as HttpURLConnection

          connection.setRequestMethod('POST')
          connection.setDoOutput(true)
          connection.setRequestProperty('Content-Type', 'application/json')
          connection.setConnectTimeout(15000)
          connection.setReadTimeout(15000)

          def requestBody = [
            capexId: execution.getVariable('capexId'),
            requestAmount: execution.getVariable('requestAmount'),
            departmentName: execution.getVariable('departmentName')
          ]

          def jsonBody = new JsonBuilder(requestBody).toString()
          connection.outputStream.withWriter { it.write(jsonBody) }

          def responseCode = connection.responseCode
          if (responseCode == 200 || responseCode == 201) {
            def response = new JsonSlurper().parseText(connection.inputStream.text)
            execution.setVariable('budgetAvailable', response.budgetAvailable)
            execution.setVariable('availableBudget', response.availableBudget)
          } else {
            throw new RuntimeException("Failed to check budget: HTTP ${responseCode}")
          }
        ]]>
      </script>
    </scriptTask>

    <!-- Exclusive Gateway: Budget Available? -->
    <exclusiveGateway id="budgetGateway" name="Budget Available?" />

    <!-- User Task: Department Manager Approval -->
    <userTask id="managerApproval" name="Manager Review" flowable:candidateGroups="FINANCE_MANAGER" flowable:formKey="capex-approval">
      <documentation>Department manager reviews and approves/rejects the CapEx request</documentation>
      <extensionElements>
        <flowable:taskListener event="complete" delegateExpression="${approvalTaskCompletionListener}" />
      </extensionElements>
    </userTask>

    <!-- Exclusive Gateway: Check Amount for VP Approval -->
    <exclusiveGateway id="amountGateway" name="Amount > $50,000?" />

    <!-- User Task: VP Approval (for amounts > $50k) -->
    <userTask id="vpApproval" name="VP Review" flowable:candidateGroups="FINANCE_VP" flowable:formKey="capex-approval">
      <documentation>VP reviews high-value CapEx requests exceeding $50,000</documentation>
      <extensionElements>
        <flowable:taskListener event="complete" delegateExpression="${approvalTaskCompletionListener}" />
      </extensionElements>
    </userTask>

    <!-- Exclusive Gateway: Check Amount for CFO Approval -->
    <exclusiveGateway id="cfoGateway" name="Amount > $250,000?" />

    <!-- User Task: CFO Approval (for amounts > $250k) -->
    <userTask id="cfoApproval" name="CFO Review" flowable:candidateGroups="FINANCE_CFO" flowable:formKey="capex-approval">
      <documentation>CFO reviews very high-value CapEx requests exceeding $250,000</documentation>
      <extensionElements>
        <flowable:taskListener event="complete" delegateExpression="${approvalTaskCompletionListener}" />
      </extensionElements>
    </userTask>

    <!-- Merge Gateway: Collect all approval paths -->
    <exclusiveGateway id="mergeGateway" name="Merge Approvals" />

    <!-- Exclusive Gateway: Final Decision -->
    <exclusiveGateway id="decisionGateway" name="Approved?" />

    <!-- Script Task: Update CapEx Status - Approved via REST API -->
    <scriptTask id="updateApproved" name="Update Status: Approved" scriptFormat="groovy">
      <documentation>Updates CapEx request status to APPROVED in Finance Service</documentation>
      <script>
        <![CDATA[
          import groovy.json.JsonBuilder
          import java.net.HttpURLConnection

          def financeServiceUrl = execution.getVariable('financeServiceUrl')
          def url = new URL("${financeServiceUrl}/api/workflow/capex/update-status")
          def connection = url.openConnection() as HttpURLConnection

          connection.setRequestMethod('PUT')
          connection.setDoOutput(true)
          connection.setRequestProperty('Content-Type', 'application/json')
          connection.setConnectTimeout(15000)
          connection.setReadTimeout(15000)

          def requestBody = [
            capexId: execution.getVariable('capexId'),
            status: 'APPROVED',
            comments: execution.getVariable('approvalComments')
          ]

          def jsonBody = new JsonBuilder(requestBody).toString()
          connection.outputStream.withWriter { it.write(jsonBody) }

          def responseCode = connection.responseCode
          if (responseCode != 200 && responseCode != 204) {
            throw new RuntimeException("Failed to update status: HTTP ${responseCode}")
          }
        ]]>
      </script>
    </scriptTask>

    <!-- Script Task: Reserve Budget via REST API -->
    <scriptTask id="reserveBudget" name="Reserve Budget" scriptFormat="groovy">
      <documentation>Reserves the approved budget amount in the Finance Service</documentation>
      <script>
        <![CDATA[
          import groovy.json.JsonBuilder
          import java.net.HttpURLConnection

          def financeServiceUrl = execution.getVariable('financeServiceUrl')
          def url = new URL("${financeServiceUrl}/api/workflow/capex/allocate")
          def connection = url.openConnection() as HttpURLConnection

          connection.setRequestMethod('POST')
          connection.setDoOutput(true)
          connection.setRequestProperty('Content-Type', 'application/json')
          connection.setConnectTimeout(15000)
          connection.setReadTimeout(15000)

          def requestBody = [
            capexId: execution.getVariable('capexId'),
            requestAmount: execution.getVariable('requestAmount'),
            departmentName: execution.getVariable('departmentName')
          ]

          def jsonBody = new JsonBuilder(requestBody).toString()
          connection.outputStream.withWriter { it.write(jsonBody) }

          def responseCode = connection.responseCode
          if (responseCode != 200 && responseCode != 201) {
            throw new RuntimeException("Failed to allocate budget: HTTP ${responseCode}")
          }
        ]]>
      </script>
    </scriptTask>

    <!-- Service Task: Send Approval Notification -->
    <serviceTask id="sendApprovalNotification" name="Send Approval Notification"
                 flowable:delegateExpression="${notificationDelegate}">
      <documentation>Sends email notification to requester about approval</documentation>
      <extensionElements>
        <flowable:field name="notificationType">
          <flowable:string><![CDATA[CAPEX_APPROVED]]></flowable:string>
        </flowable:field>
      </extensionElements>
    </serviceTask>

    <!-- Script Task: Update CapEx Status - Rejected via REST API -->
    <scriptTask id="updateRejected" name="Update Status: Rejected" scriptFormat="groovy">
      <documentation>Updates CapEx request status to REJECTED in Finance Service</documentation>
      <script>
        <![CDATA[
          import groovy.json.JsonBuilder
          import java.net.HttpURLConnection

          def financeServiceUrl = execution.getVariable('financeServiceUrl')
          def url = new URL("${financeServiceUrl}/api/workflow/capex/update-status")
          def connection = url.openConnection() as HttpURLConnection

          connection.setRequestMethod('PUT')
          connection.setDoOutput(true)
          connection.setRequestProperty('Content-Type', 'application/json')
          connection.setConnectTimeout(15000)
          connection.setReadTimeout(15000)

          def requestBody = [
            capexId: execution.getVariable('capexId'),
            status: 'REJECTED',
            comments: execution.getVariable('rejectionReason')
          ]

          def jsonBody = new JsonBuilder(requestBody).toString()
          connection.outputStream.withWriter { it.write(jsonBody) }

          def responseCode = connection.responseCode
          if (responseCode != 200 && responseCode != 204) {
            throw new RuntimeException("Failed to update status: HTTP ${responseCode}")
          }
        ]]>
      </script>
    </scriptTask>

    <!-- Service Task: Send Rejection Notification -->
    <serviceTask id="sendRejectionNotification" name="Send Rejection Notification"
                 flowable:delegateExpression="${notificationDelegate}">
      <documentation>Sends email notification to requester about rejection</documentation>
      <extensionElements>
        <flowable:field name="notificationType">
          <flowable:string><![CDATA[CAPEX_REJECTED]]></flowable:string>
        </flowable:field>
      </extensionElements>
    </serviceTask>

    <!-- End Events -->
    <endEvent id="endEventApproved" name="Request Approved" />
    <endEvent id="endEventRejected" name="Request Rejected" />
    <endEvent id="endEventNoBudget" name="Insufficient Budget" />

    <!-- Sequence Flows -->
    <sequenceFlow id="flow1" sourceRef="startEvent" targetRef="createCapExRequest" />
    <sequenceFlow id="flow2" sourceRef="createCapExRequest" targetRef="checkBudget" />
    <sequenceFlow id="flow3" sourceRef="checkBudget" targetRef="budgetGateway" />

    <!-- Budget Gateway Flows -->
    <sequenceFlow id="budgetYes" sourceRef="budgetGateway" targetRef="managerApproval">
      <conditionExpression xsi:type="tFormalExpression">${budgetAvailable == true}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="budgetNo" sourceRef="budgetGateway" targetRef="endEventNoBudget">
      <conditionExpression xsi:type="tFormalExpression">${budgetAvailable == false}</conditionExpression>
    </sequenceFlow>

    <!-- After manager approval, check if rejected or continue to amount-based routing -->
    <sequenceFlow id="flow4" sourceRef="managerApproval" targetRef="amountGateway" />

    <!-- Amount Gateway Flows -->
    <!-- If manager rejected, skip further approvals and go to merge -->
    <sequenceFlow id="managerRejected" sourceRef="amountGateway" targetRef="mergeGateway">
      <conditionExpression xsi:type="tFormalExpression">${managerApproved == false}</conditionExpression>
    </sequenceFlow>
    <!-- If amount <= 50k and manager approved, proceed to final decision -->
    <sequenceFlow id="amountLow" sourceRef="amountGateway" targetRef="mergeGateway">
      <conditionExpression xsi:type="tFormalExpression">${managerApproved == true &amp;&amp; requestAmount &lt;= 50000}</conditionExpression>
    </sequenceFlow>
    <!-- If amount > 50k and manager approved, get VP approval -->
    <sequenceFlow id="amountHigh" sourceRef="amountGateway" targetRef="vpApproval">
      <conditionExpression xsi:type="tFormalExpression">${managerApproved == true &amp;&amp; requestAmount &gt; 50000}</conditionExpression>
    </sequenceFlow>

    <!-- After VP approval, check if rejected or continue to CFO routing -->
    <sequenceFlow id="flow5" sourceRef="vpApproval" targetRef="cfoGateway" />

    <!-- CFO Gateway Flows -->
    <!-- If VP rejected, skip CFO approval and go to merge -->
    <sequenceFlow id="vpRejected" sourceRef="cfoGateway" targetRef="mergeGateway">
      <conditionExpression xsi:type="tFormalExpression">${vpApproved == false}</conditionExpression>
    </sequenceFlow>
    <!-- If amount <= 250k and VP approved, proceed to final decision -->
    <sequenceFlow id="cfoNotNeeded" sourceRef="cfoGateway" targetRef="mergeGateway">
      <conditionExpression xsi:type="tFormalExpression">${vpApproved == true &amp;&amp; requestAmount &lt;= 250000}</conditionExpression>
    </sequenceFlow>
    <!-- If amount > 250k and VP approved, get CFO approval -->
    <sequenceFlow id="cfoNeeded" sourceRef="cfoGateway" targetRef="cfoApproval">
      <conditionExpression xsi:type="tFormalExpression">${vpApproved == true &amp;&amp; requestAmount &gt; 250000}</conditionExpression>
    </sequenceFlow>

    <sequenceFlow id="flow6" sourceRef="cfoApproval" targetRef="mergeGateway" />
    <sequenceFlow id="flow7" sourceRef="mergeGateway" targetRef="decisionGateway" />

    <!-- Decision Gateway Flows -->
    <!-- All required approvals must be true for approval -->
    <!-- Logic: Check that all approval levels that were required returned true -->
    <!-- For amounts <= 50k: only managerApproved needed -->
    <!-- For amounts > 50k and <= 250k: managerApproved AND vpApproved needed -->
    <!-- For amounts > 250k: managerApproved AND vpApproved AND cfoApproved needed -->
    <sequenceFlow id="approved" sourceRef="decisionGateway" targetRef="updateApproved">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[
        ${
          (managerApproved == true) &&
          (requestAmount <= 50000 || (vpApproved == true && (requestAmount <= 250000 || cfoApproved == true)))
        }
      ]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="rejected" sourceRef="decisionGateway" targetRef="updateRejected">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[
        ${
          (managerApproved == false) ||
          (requestAmount > 50000 && vpApproved == false) ||
          (requestAmount > 250000 && cfoApproved == false)
        }
      ]]></conditionExpression>
    </sequenceFlow>

    <!-- Approval Path -->
    <sequenceFlow id="flow8" sourceRef="updateApproved" targetRef="reserveBudget" />
    <sequenceFlow id="flow9" sourceRef="reserveBudget" targetRef="sendApprovalNotification" />
    <sequenceFlow id="flow10" sourceRef="sendApprovalNotification" targetRef="endEventApproved" />

    <!-- Rejection Path -->
    <sequenceFlow id="flow11" sourceRef="updateRejected" targetRef="sendRejectionNotification" />
    <sequenceFlow id="flow12" sourceRef="sendRejectionNotification" targetRef="endEventRejected" />

  </process>

  <!-- BPMN Diagram (Visual Layout) -->
  <bpmndi:BPMNDiagram id="BPMNDiagram_capex-approval-process-v2">
    <bpmndi:BPMNPlane bpmnElement="capex-approval-process-v2" id="BPMNPlane_capex-approval-process-v2">

      <!-- Start Event -->
      <bpmndi:BPMNShape bpmnElement="startEvent" id="BPMNShape_startEvent">
        <omgdc:Bounds height="30.0" width="30.0" x="100.0" y="163.0"/>
      </bpmndi:BPMNShape>

      <!-- Service Tasks -->
      <bpmndi:BPMNShape bpmnElement="createCapExRequest" id="BPMNShape_createCapExRequest">
        <omgdc:Bounds height="80.0" width="100.0" x="180.0" y="138.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="checkBudget" id="BPMNShape_checkBudget">
        <omgdc:Bounds height="80.0" width="100.0" x="330.0" y="138.0"/>
      </bpmndi:BPMNShape>

      <!-- Gateways -->
      <bpmndi:BPMNShape bpmnElement="budgetGateway" id="BPMNShape_budgetGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="480.0" y="158.0"/>
      </bpmndi:BPMNShape>

      <!-- User Tasks -->
      <bpmndi:BPMNShape bpmnElement="managerApproval" id="BPMNShape_managerApproval">
        <omgdc:Bounds height="80.0" width="100.0" x="870.0" y="138.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="amountGateway" id="BPMNShape_amountGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="1020.0" y="158.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="vpApproval" id="BPMNShape_vpApproval">
        <omgdc:Bounds height="80.0" width="100.0" x="1110.0" y="138.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="cfoGateway" id="BPMNShape_cfoGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="1260.0" y="158.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="cfoApproval" id="BPMNShape_cfoApproval">
        <omgdc:Bounds height="80.0" width="100.0" x="1350.0" y="138.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="mergeGateway" id="BPMNShape_mergeGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="1500.0" y="158.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="decisionGateway" id="BPMNShape_decisionGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="1590.0" y="158.0"/>
      </bpmndi:BPMNShape>

      <!-- Approval Path -->
      <bpmndi:BPMNShape bpmnElement="updateApproved" id="BPMNShape_updateApproved">
        <omgdc:Bounds height="80.0" width="100.0" x="1680.0" y="50.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="reserveBudget" id="BPMNShape_reserveBudget">
        <omgdc:Bounds height="80.0" width="100.0" x="1830.0" y="50.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="sendApprovalNotification" id="BPMNShape_sendApprovalNotification">
        <omgdc:Bounds height="80.0" width="100.0" x="1980.0" y="50.0"/>
      </bpmndi:BPMNShape>

      <!-- Rejection Path -->
      <bpmndi:BPMNShape bpmnElement="updateRejected" id="BPMNShape_updateRejected">
        <omgdc:Bounds height="80.0" width="100.0" x="1680.0" y="250.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="sendRejectionNotification" id="BPMNShape_sendRejectionNotification">
        <omgdc:Bounds height="80.0" width="100.0" x="1830.0" y="250.0"/>
      </bpmndi:BPMNShape>

      <!-- End Events -->
      <bpmndi:BPMNShape bpmnElement="endEventApproved" id="BPMNShape_endEventApproved">
        <omgdc:Bounds height="28.0" width="28.0" x="2130.0" y="76.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="endEventRejected" id="BPMNShape_endEventRejected">
        <omgdc:Bounds height="28.0" width="28.0" x="1980.0" y="276.0"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape bpmnElement="endEventNoBudget" id="BPMNShape_endEventNoBudget">
        <omgdc:Bounds height="28.0" width="28.0" x="486.0" y="250.0"/>
      </bpmndi:BPMNShape>

      <!-- Sequence Flow Edges -->
      <bpmndi:BPMNEdge bpmnElement="flow1" id="BPMNEdge_flow1">
        <omgdi:waypoint x="130.0" y="178.0"/>
        <omgdi:waypoint x="180.0" y="178.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow2" id="BPMNEdge_flow2">
        <omgdi:waypoint x="280.0" y="178.0"/>
        <omgdi:waypoint x="330.0" y="178.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow3" id="BPMNEdge_flow3">
        <omgdi:waypoint x="430.0" y="178.0"/>
        <omgdi:waypoint x="480.0" y="178.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="budgetYes" id="BPMNEdge_budgetYes">
        <omgdi:waypoint x="520.0" y="178.0"/>
        <omgdi:waypoint x="870.0" y="178.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="budgetNo" id="BPMNEdge_budgetNo">
        <omgdi:waypoint x="500.0" y="198.0"/>
        <omgdi:waypoint x="500.0" y="250.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow4" id="BPMNEdge_flow4">
        <omgdi:waypoint x="970.0" y="178.0"/>
        <omgdi:waypoint x="1020.0" y="178.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="managerRejected" id="BPMNEdge_managerRejected">
        <omgdi:waypoint x="1040.0" y="198.0"/>
        <omgdi:waypoint x="1040.0" y="320.0"/>
        <omgdi:waypoint x="1520.0" y="320.0"/>
        <omgdi:waypoint x="1520.0" y="198.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="amountLow" id="BPMNEdge_amountLow">
        <omgdi:waypoint x="1040.0" y="198.0"/>
        <omgdi:waypoint x="1040.0" y="240.0"/>
        <omgdi:waypoint x="1520.0" y="240.0"/>
        <omgdi:waypoint x="1520.0" y="198.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="amountHigh" id="BPMNEdge_amountHigh">
        <omgdi:waypoint x="1060.0" y="178.0"/>
        <omgdi:waypoint x="1110.0" y="178.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow5" id="BPMNEdge_flow5">
        <omgdi:waypoint x="1210.0" y="178.0"/>
        <omgdi:waypoint x="1260.0" y="178.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="vpRejected" id="BPMNEdge_vpRejected">
        <omgdi:waypoint x="1280.0" y="198.0"/>
        <omgdi:waypoint x="1280.0" y="300.0"/>
        <omgdi:waypoint x="1520.0" y="300.0"/>
        <omgdi:waypoint x="1520.0" y="198.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="cfoNotNeeded" id="BPMNEdge_cfoNotNeeded">
        <omgdi:waypoint x="1280.0" y="198.0"/>
        <omgdi:waypoint x="1280.0" y="260.0"/>
        <omgdi:waypoint x="1520.0" y="260.0"/>
        <omgdi:waypoint x="1520.0" y="198.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="cfoNeeded" id="BPMNEdge_cfoNeeded">
        <omgdi:waypoint x="1300.0" y="178.0"/>
        <omgdi:waypoint x="1350.0" y="178.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow6" id="BPMNEdge_flow6">
        <omgdi:waypoint x="1450.0" y="178.0"/>
        <omgdi:waypoint x="1500.0" y="178.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow7" id="BPMNEdge_flow7">
        <omgdi:waypoint x="1540.0" y="178.0"/>
        <omgdi:waypoint x="1590.0" y="178.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="approved" id="BPMNEdge_approved">
        <omgdi:waypoint x="1610.0" y="158.0"/>
        <omgdi:waypoint x="1610.0" y="90.0"/>
        <omgdi:waypoint x="1680.0" y="90.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="rejected" id="BPMNEdge_rejected">
        <omgdi:waypoint x="1610.0" y="198.0"/>
        <omgdi:waypoint x="1610.0" y="290.0"/>
        <omgdi:waypoint x="1680.0" y="290.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow8" id="BPMNEdge_flow8">
        <omgdi:waypoint x="1780.0" y="90.0"/>
        <omgdi:waypoint x="1830.0" y="90.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow9" id="BPMNEdge_flow9">
        <omgdi:waypoint x="1930.0" y="90.0"/>
        <omgdi:waypoint x="1980.0" y="90.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow10" id="BPMNEdge_flow10">
        <omgdi:waypoint x="2080.0" y="90.0"/>
        <omgdi:waypoint x="2130.0" y="90.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow11" id="BPMNEdge_flow11">
        <omgdi:waypoint x="1780.0" y="290.0"/>
        <omgdi:waypoint x="1830.0" y="290.0"/>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge bpmnElement="flow12" id="BPMNEdge_flow12">
        <omgdi:waypoint x="1930.0" y="290.0"/>
        <omgdi:waypoint x="1980.0" y="290.0"/>
      </bpmndi:BPMNEdge>

    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>

</definitions>
