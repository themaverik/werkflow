<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:xsd="http://www.w3.org/2001/XMLSchema"
             xmlns:flowable="http://flowable.org/bpmn"
             typeLanguage="http://www.w3.org/2001/XMLSchema"
             expressionLanguage="http://www.w3.org/1999/XPath"
             targetNamespace="http://www.werkflow.com/bpmn">

  <process id="employeeOnboardingProcess" name="Employee Onboarding Process" isExecutable="true">

    <documentation>
      Comprehensive workflow for onboarding new employees from hire to first day completion.
    </documentation>

    <!-- Start Event -->
    <startEvent id="startEvent" name="New Employee Hired">
      <extensionElements>
        <flowable:formProperty id="employeeId" name="Employee ID" type="long" required="true"/>
        <flowable:formProperty id="employeeName" name="Employee Name" type="string" required="true"/>
        <flowable:formProperty id="employeeEmail" name="Employee Email" type="string" required="true"/>
        <flowable:formProperty id="departmentId" name="Department ID" type="long" required="true"/>
        <flowable:formProperty id="position" name="Position" type="string" required="true"/>
        <flowable:formProperty id="startDate" name="Start Date" type="date" required="true"/>
        <flowable:formProperty id="managerId" name="Manager ID" type="long" required="true"/>
      </extensionElements>
    </startEvent>

    <!-- Parallel Gateway: Split into multiple parallel tasks -->
    <parallelGateway id="parallelSplitGateway" name="Parallel Split"/>

    <!-- User Task: IT Account Setup -->
    <userTask id="itAccountSetupTask" name="IT Account Setup" flowable:candidateGroups="IT">
      <documentation>
        IT team creates employee accounts, provisions equipment, and sets up access.
      </documentation>
      <extensionElements>
        <flowable:formProperty id="employeeId" name="Employee ID" type="long" writable="false"/>
        <flowable:formProperty id="employeeName" name="Employee Name" type="string" writable="false"/>
        <flowable:formProperty id="employeeEmail" name="Employee Email" type="string" writable="false"/>
        <flowable:formProperty id="emailAccountCreated" name="Email Account Created" type="boolean" required="true"/>
        <flowable:formProperty id="laptopAssigned" name="Laptop Assigned" type="boolean" required="true"/>
        <flowable:formProperty id="systemAccessGranted" name="System Access Granted" type="boolean" required="true"/>
        <flowable:formProperty id="itNotes" name="IT Notes" type="string"/>
      </extensionElements>
    </userTask>

    <!-- User Task: HR Documentation -->
    <userTask id="hrDocumentationTask" name="HR Documentation" flowable:candidateGroups="HR_ADMIN">
      <documentation>
        HR collects and verifies all necessary employment documents.
      </documentation>
      <extensionElements>
        <flowable:formProperty id="employeeId" name="Employee ID" type="long" writable="false"/>
        <flowable:formProperty id="employeeName" name="Employee Name" type="string" writable="false"/>
        <flowable:formProperty id="contractSigned" name="Contract Signed" type="boolean" required="true"/>
        <flowable:formProperty id="taxFormsCompleted" name="Tax Forms Completed" type="boolean" required="true"/>
        <flowable:formProperty id="benefitsEnrolled" name="Benefits Enrolled" type="boolean" required="true"/>
        <flowable:formProperty id="emergencyContactProvided" name="Emergency Contact Provided" type="boolean" required="true"/>
        <flowable:formProperty id="hrNotes" name="HR Notes" type="string"/>
      </extensionElements>
    </userTask>

    <!-- User Task: Manager Preparation -->
    <userTask id="managerPreparationTask" name="Manager Preparation" flowable:candidateGroups="MANAGER">
      <documentation>
        Manager prepares for new employee arrival, assigns buddy, and plans first week.
      </documentation>
      <extensionElements>
        <flowable:formProperty id="employeeId" name="Employee ID" type="long" writable="false"/>
        <flowable:formProperty id="employeeName" name="Employee Name" type="string" writable="false"/>
        <flowable:formProperty id="position" name="Position" type="string" writable="false"/>
        <flowable:formProperty id="buddyAssigned" name="Buddy Assigned" type="boolean" required="true"/>
        <flowable:formProperty id="buddyName" name="Buddy Name" type="string"/>
        <flowable:formProperty id="workspaceReady" name="Workspace Ready" type="boolean" required="true"/>
        <flowable:formProperty id="firstWeekScheduled" name="First Week Scheduled" type="boolean" required="true"/>
        <flowable:formProperty id="managerNotes" name="Manager Notes" type="string"/>
      </extensionElements>
    </userTask>

    <!-- Parallel Gateway: Join parallel tasks -->
    <parallelGateway id="parallelJoinGateway" name="Parallel Join"/>

    <!-- Service Task: Send Welcome Email -->
    <serviceTask id="sendWelcomeEmailTask" name="Send Welcome Email"
                 flowable:delegateExpression="${sendWelcomeEmailDelegate}">
      <documentation>
        Sends welcome email to new employee with onboarding information.
      </documentation>
    </serviceTask>

    <!-- User Task: First Day Orientation -->
    <userTask id="firstDayOrientationTask" name="First Day Orientation" flowable:candidateGroups="HR_ADMIN">
      <documentation>
        HR conducts first day orientation and ensures employee is settled.
      </documentation>
      <extensionElements>
        <flowable:formProperty id="employeeId" name="Employee ID" type="long" writable="false"/>
        <flowable:formProperty id="employeeName" name="Employee Name" type="string" writable="false"/>
        <flowable:formProperty id="orientationCompleted" name="Orientation Completed" type="boolean" required="true"/>
        <flowable:formProperty id="companyPoliciesReviewed" name="Company Policies Reviewed" type="boolean" required="true"/>
        <flowable:formProperty id="teamIntroductionDone" name="Team Introduction Done" type="boolean" required="true"/>
        <flowable:formProperty id="firstDayNotes" name="First Day Notes" type="string"/>
      </extensionElements>
    </userTask>

    <!-- Service Task: Update Employee Status -->
    <serviceTask id="updateEmployeeStatusTask" name="Update Employee Status"
                 flowable:delegateExpression="${updateEmployeeStatusDelegate}">
      <documentation>
        Updates employee status to ACTIVE in the system.
      </documentation>
    </serviceTask>

    <!-- Service Task: Notify Stakeholders -->
    <serviceTask id="notifyStakeholdersTask" name="Notify Stakeholders"
                 flowable:delegateExpression="${notifyStakeholdersDelegate}">
      <documentation>
        Notifies relevant stakeholders that onboarding is complete.
      </documentation>
    </serviceTask>

    <!-- End Event -->
    <endEvent id="onboardingCompleteEndEvent" name="Onboarding Complete"/>

    <!-- Sequence Flows -->
    <sequenceFlow id="flow1" sourceRef="startEvent" targetRef="parallelSplitGateway"/>

    <!-- Parallel branches -->
    <sequenceFlow id="flow2a" sourceRef="parallelSplitGateway" targetRef="itAccountSetupTask"/>
    <sequenceFlow id="flow2b" sourceRef="parallelSplitGateway" targetRef="hrDocumentationTask"/>
    <sequenceFlow id="flow2c" sourceRef="parallelSplitGateway" targetRef="managerPreparationTask"/>

    <!-- Join parallel branches -->
    <sequenceFlow id="flow3a" sourceRef="itAccountSetupTask" targetRef="parallelJoinGateway"/>
    <sequenceFlow id="flow3b" sourceRef="hrDocumentationTask" targetRef="parallelJoinGateway"/>
    <sequenceFlow id="flow3c" sourceRef="managerPreparationTask" targetRef="parallelJoinGateway"/>

    <!-- Continue after join -->
    <sequenceFlow id="flow4" sourceRef="parallelJoinGateway" targetRef="sendWelcomeEmailTask"/>
    <sequenceFlow id="flow5" sourceRef="sendWelcomeEmailTask" targetRef="firstDayOrientationTask"/>
    <sequenceFlow id="flow6" sourceRef="firstDayOrientationTask" targetRef="updateEmployeeStatusTask"/>
    <sequenceFlow id="flow7" sourceRef="updateEmployeeStatusTask" targetRef="notifyStakeholdersTask"/>
    <sequenceFlow id="flow8" sourceRef="notifyStakeholdersTask" targetRef="onboardingCompleteEndEvent"/>

  </process>

</definitions>
